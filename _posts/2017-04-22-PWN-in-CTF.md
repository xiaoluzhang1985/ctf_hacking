---
layout: default
title: PWN in CTF
---

<h2>{{ page.title }}</h2>


0x0 Instruction
---
  PWN in CTF are mostly based on exploring and utilize buffer overflow weaknesses. In order to Pwn the question the well known of stack overflow, stack protection techniques and shellcode are needed.

0X1 Stack overflow
---
Performing the stack overflow attack needs hackers having the deep understanding of the target program, which basicly relys on their reverse engineering techniques. Therefore, it is also platform-related. Different oprating system / CPU architectures requires different RE solution.

Otherwise the article[0] below had a very well explaination for x86_64bit Linux buffer overflow.

0x2 ASLR, Stack Canary, NX or PIE
---
They are all exploit mitigation techniques.

NX Bit makes certain areas of memory non executable. Note that NX Bit is set by gcc.

1.Switch off stack protection:

```
gcc -fno-stack-protector -z execstack
```

If ALSR is on every time executing the program, it will be loaded to different memory address. Note that ALSR is set by the OS. 

1.Check ALSR:
```
cat /proc/sys/kernel/randomize_va_space
```

2.Switch off ALSR:
```
sudo echo 0 > /proc/sys/kernel/randomize_va_space
```
    
0x3 Common procedure
---
1. Detect packer (Usually UPX in Linux)
2. checksec.sh DEP and ALSR
3. Assembly code Analysis (stack structure) in order to set breakpoint in gdb. 
   The breakpoint should be set after the stack is filled.
4. Locate RIP.
5. if (NX is off) /* using "-z execstack" while compilation */
      Upload executable payload to the stack.
   else
      "ret2libc".
   if ()

0x4 Useful commands
---
1.Pass payload to the target program:
```
 ./bof $(python -c 'print "A" * 264 + " \x7f\xff\xff\xff\xdc\x90"[:: -1]')
 cat payload.txt | ./bof
```
2.Pass payload to the target program as a parameter:
```
python -c "print 'A'*64+'\x5b\x84\x04\x08'" |xargs ./bof
```
3.Pass payload to gdb:
```
run $(python -c 'print "A" * 264 + " \x7f\xff\xff\xff\xdc\x90"[:: -1]')
```

0x5 Reference
---
[0]https://www.exploit-db.com/docs/33698.pdf

[1]http://blog.csdn.net/caterpillarous/article/details/51177527

[2]http://www.jianshu.com/p/a659924515f7

[3]https://sploitfun.wordpress.com/2015/

[4]https://blog.techorganic.com/2015/04/10/64-bit-linux-stack-smashing-tutorial-part-1/

<h2>{{ page.date | date_to_string }}</h2>
